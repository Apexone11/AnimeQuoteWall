<Page x:Class="AnimeQuoteWall.GUI.Pages.AnimationPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Animation">
    <Grid Margin="20,16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*" MinHeight="300"/>
            <RowDefinition Height="*" MinHeight="300"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0"
                   FontSize="22"
                   FontWeight="Bold"
                   Foreground="{StaticResource TextPrimary}"
                   Margin="0,0,0,12">
            <Run Text="ðŸŽ¬" FontFamily="Segoe UI Emoji"/>
            <Run Text=" Create Animated Wallpaper"/>
        </TextBlock>

        <!-- Animation Preview Section -->
        <Border Grid.Row="1"
                Background="{StaticResource HoverBackground}"
                BorderBrush="{StaticResource BorderColor}"
                BorderThickness="2"
                CornerRadius="12"
                Margin="0,0,0,12"
                Padding="6"
                MinHeight="300">
            <Border.Effect>
                <DropShadowEffect Color="#1E293B" Opacity="0.06" BlurRadius="8" ShadowDepth="1"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <!-- Preview Header with Info -->
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                    <TextBlock Text="Animation Preview"
                               FontSize="18"
                               FontWeight="Bold"
                               Foreground="{StaticResource TextPrimary}"
                               VerticalAlignment="Center"/>
                    <TextBlock x:Name="FrameInfoText"
                               FontSize="13"
                               Foreground="{StaticResource TextSecondary}"
                               Margin="16,0,0,0"
                               VerticalAlignment="Center">
                        <Run Text="Frame:"/>
                        <Run x:Name="CurrentFrameRun" Text="0" FontWeight="Bold"/>
                        <Run Text="/"/>
                        <Run x:Name="TotalFramesRun" Text="0" FontWeight="Bold"/>
                        <Run Text=" | Duration:"/>
                        <Run x:Name="DurationRun" Text="0s" FontWeight="Bold"/>
                    </TextBlock>
                </StackPanel>
                
                <!-- Preview Image -->
                <ScrollViewer Grid.Row="1"
                              x:Name="AnimationPreviewScrollViewer"
                              HorizontalScrollBarVisibility="Auto"
                              VerticalScrollBarVisibility="Auto"
                              PanningMode="Both">
                    <Image x:Name="AnimationPreview"
                           Stretch="Uniform"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           RenderTransformOrigin="0.5,0.5"
                           MaxWidth="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=ScrollViewer}}"
                           MaxHeight="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=ScrollViewer}}">
                        <Image.RenderTransform>
                            <ScaleTransform x:Name="AnimationPreviewScaleTransform" ScaleX="1" ScaleY="1"/>
                        </Image.RenderTransform>
                    </Image>
                </ScrollViewer>
                
                <!-- Frame Navigation Controls -->
                <Border Grid.Row="2"
                        Background="{StaticResource CardBackground}"
                        BorderBrush="{StaticResource BorderColor}"
                        BorderThickness="0,1,0,0"
                        Padding="12,8"
                        Margin="0,8,0,0"
                        Visibility="Collapsed"
                        x:Name="FrameNavigationBorder">
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                        <Button x:Name="FirstFrameButton"
                                Content="â®"
                                Width="36"
                                Height="36"
                                Click="FirstFrameButton_Click"
                                Style="{StaticResource ModernPrimaryButton}"
                                Margin="0,0,4,0"
                                Padding="0"
                                FontSize="16"
                                ToolTip="First Frame"/>
                        <Button x:Name="PreviousFrameButton"
                                Content="âª"
                                Width="36"
                                Height="36"
                                Click="PreviousFrameButton_Click"
                                Style="{StaticResource ModernPrimaryButton}"
                                Margin="0,0,4,0"
                                Padding="0"
                                FontSize="16"
                                ToolTip="Previous Frame"/>
                        <TextBox x:Name="FrameNumberTextBox"
                                 Width="60"
                                 Height="36"
                                 TextAlignment="Center"
                                 VerticalContentAlignment="Center"
                                 Text="1"
                                 Margin="0,0,4,0"
                                 KeyDown="FrameNumberTextBox_KeyDown"/>
                        <TextBlock Text="/"
                                   VerticalAlignment="Center"
                                   Margin="0,0,4,0"
                                   Foreground="{StaticResource TextSecondary}"/>
                        <TextBlock x:Name="MaxFrameText"
                                   Text="0"
                                   VerticalAlignment="Center"
                                   Foreground="{StaticResource TextSecondary}"
                                   Margin="0,0,4,0"/>
                        <Button x:Name="NextFrameButton"
                                Content="â©"
                                Width="36"
                                Height="36"
                                Click="NextFrameButton_Click"
                                Style="{StaticResource ModernPrimaryButton}"
                                Margin="0,0,4,0"
                                Padding="0"
                                FontSize="16"
                                ToolTip="Next Frame"/>
                        <Button x:Name="LastFrameButton"
                                Content="â­"
                                Width="36"
                                Height="36"
                                Click="LastFrameButton_Click"
                                Style="{StaticResource ModernPrimaryButton}"
                                Margin="0,0,0,0"
                                Padding="0"
                                FontSize="16"
                                ToolTip="Last Frame"/>
                    </StackPanel>
                </Border>
                
                <!-- No Preview Message -->
                <Border Grid.Row="1"
                        x:Name="NoAnimationPreviewBorder"
                        Background="Transparent"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center">
                    <StackPanel>
                        <TextBlock Text="ðŸŽ¬"
                                   FontSize="48"
                                   HorizontalAlignment="Center"
                                   Margin="0,0,0,12"
                                   Opacity="0.3"/>
                        <TextBlock x:Name="NoAnimationPreviewText"
                                   Text="No animation preview available.&#x0a;Generate animation frames to see preview!"
                                   FontSize="15"
                                   Foreground="{StaticResource TextTertiary}"
                                   HorizontalAlignment="Center"
                                   TextAlignment="Center"
                                   TextWrapping="Wrap"
                                   MaxWidth="400"
                                   LineHeight="24"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Load Media Card -->
                <Border Style="{StaticResource ModernCard}" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="{StaticResource TextPrimary}"
                                   Margin="0,0,0,14">
                            <Run Text="ðŸ“" FontFamily="Segoe UI Emoji"/>
                            <Run Text=" Load Media"/>
                        </TextBlock>
                        <Button x:Name="LoadMediaButton"
                                MinWidth="200"
                                Height="40"
                                Click="LoadMediaButton_Click"
                                Style="{StaticResource ModernPrimaryButton}"
                                Margin="0,0,0,12"
                                Padding="14,9">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“‚" FontSize="15" Margin="0,0,6,0" FontFamily="Segoe UI Emoji"/>
                                <TextBlock Text="Load Image/Video" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        <TextBlock x:Name="LoadedMediaText"
                                   FontSize="13"
                                   Foreground="{StaticResource TextSecondary}"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Editing Controls Card -->
                <Border Style="{StaticResource ModernCard}" Margin="0,0,0,12" x:Name="EditingControlsCard" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="{StaticResource TextPrimary}"
                                   Margin="0,0,0,14">
                            <Run Text="âœ‚ï¸" FontFamily="Segoe UI Emoji"/>
                            <Run Text=" Editing Tools"/>
                        </TextBlock>

                        <!-- Crop Tool -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Crop (X, Y, Width, Height):"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="CropXTextBox" Grid.Column="0" Text="0" Margin="0,0,4,0" Padding="8" FontSize="13" Background="{StaticResource HoverBackground}" BorderBrush="{StaticResource BorderColor}" Foreground="{StaticResource TextPrimary}"/>
                                <TextBox x:Name="CropYTextBox" Grid.Column="1" Text="0" Margin="4,0,4,0" Padding="8" FontSize="13" Background="{StaticResource HoverBackground}" BorderBrush="{StaticResource BorderColor}" Foreground="{StaticResource TextPrimary}"/>
                                <TextBox x:Name="CropWidthTextBox" Grid.Column="2" Text="1920" Margin="4,0,4,0" Padding="8" FontSize="13" Background="{StaticResource HoverBackground}" BorderBrush="{StaticResource BorderColor}" Foreground="{StaticResource TextPrimary}"/>
                                <TextBox x:Name="CropHeightTextBox" Grid.Column="3" Text="1080" Margin="4,0,0,0" Padding="8" FontSize="13" Background="{StaticResource HoverBackground}" BorderBrush="{StaticResource BorderColor}" Foreground="{StaticResource TextPrimary}"/>
                            </Grid>
                            <Button x:Name="ApplyCropButton" Content="Apply Crop" Click="ApplyCropButton_Click" Style="{StaticResource ModernSecondaryButton}" Margin="0,8,0,0" Height="32"/>
                        </StackPanel>

                        <!-- Resize Tool -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Resize (Width x Height):"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="30"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="ResizeWidthTextBox" Grid.Column="0" Text="1920" Margin="0,0,4,0" Padding="8" FontSize="13" Background="{StaticResource HoverBackground}" BorderBrush="{StaticResource BorderColor}" Foreground="{StaticResource TextPrimary}"/>
                                <TextBlock Grid.Column="1" Text="Ã—" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="{StaticResource TextSecondary}"/>
                                <TextBox x:Name="ResizeHeightTextBox" Grid.Column="2" Text="1080" Margin="4,0,0,0" Padding="8" FontSize="13" Background="{StaticResource HoverBackground}" BorderBrush="{StaticResource BorderColor}" Foreground="{StaticResource TextPrimary}"/>
                            </Grid>
                            <Button x:Name="ApplyResizeButton" Content="Apply Resize" Click="ApplyResizeButton_Click" Style="{StaticResource ModernSecondaryButton}" Margin="0,8,0,0" Height="32"/>
                        </StackPanel>

                        <!-- Filter Tool -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Filter:"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <ComboBox x:Name="FilterComboBox"
                                      SelectedIndex="0"
                                      Style="{StaticResource ModernComboBox}">
                                <ComboBoxItem Content="None"/>
                                <ComboBoxItem Content="Blur"/>
                                <ComboBoxItem Content="Glow"/>
                                <ComboBoxItem Content="Sepia"/>
                                <ComboBoxItem Content="Grayscale"/>
                                <ComboBoxItem Content="Vintage"/>
                                <ComboBoxItem Content="Brightness"/>
                                <ComboBoxItem Content="Contrast"/>
                            </ComboBox>
                            <Slider x:Name="FilterIntensitySlider" Minimum="0.1" Maximum="3.0" Value="1.0" Margin="0,8,0,0" TickFrequency="0.1" IsSnapToTickEnabled="True"/>
                            <TextBlock Text="{Binding Value, ElementName=FilterIntensitySlider, StringFormat='Intensity: {0:F1}'}" FontSize="11" Foreground="{StaticResource TextTertiary}" Margin="0,4,0,0"/>
                            <Button x:Name="ApplyFilterButton" Content="Apply Filter" Click="ApplyFilterButton_Click" Style="{StaticResource ModernSecondaryButton}" Margin="0,8,0,0" Height="32"/>
                        </StackPanel>

                        <!-- Text Overlay -->
                        <StackPanel Margin="0,0,0,0">
                            <CheckBox x:Name="TextOverlayCheckBox"
                                      Content="Add Text Overlay"
                                      IsChecked="False"
                                      FontSize="14"
                                      Foreground="{StaticResource TextPrimary}"
                                      Margin="0,0,0,8"/>
                            <Button x:Name="ApplyTextOverlayButton" Content="Apply Text Overlay" Click="ApplyTextOverlayButton_Click" Style="{StaticResource ModernSecondaryButton}" Margin="0,0,0,0" Height="32" IsEnabled="False"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Animation Settings Card -->
                <Border Style="{StaticResource ModernCard}" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="{StaticResource TextPrimary}"
                                   Margin="0,0,0,14">
                            <Run Text="âš™" FontFamily="Segoe UI Emoji"/>
                            <Run Text=" Animation Settings"/>
                        </TextBlock>

                        <!-- FPS -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Frames Per Second (FPS):"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <TextBox x:Name="FpsTextBox"
                                      Text="24"
                                      Padding="12"
                                      FontSize="14"
                                      Background="{StaticResource HoverBackground}"
                                      BorderBrush="{StaticResource BorderColor}"
                                      BorderThickness="1"
                                      Foreground="{StaticResource TextPrimary}"/>
                        </StackPanel>

                        <!-- Duration -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Duration (seconds):"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <TextBox x:Name="DurationTextBox"
                                      Text="6"
                                      Padding="12"
                                      FontSize="14"
                                      Background="{StaticResource HoverBackground}"
                                      BorderBrush="{StaticResource BorderColor}"
                                      BorderThickness="1"
                                      Foreground="{StaticResource TextPrimary}"/>
                        </StackPanel>

                        <!-- Motion Type -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Motion Type:"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <ComboBox x:Name="MotionTypeComboBox"
                                      SelectedIndex="0"
                                      Style="{StaticResource ModernComboBox}">
                                <ComboBoxItem Content="Fade"/>
                                <ComboBoxItem Content="Slide"/>
                                <ComboBoxItem Content="Zoom"/>
                                <ComboBoxItem Content="Pan"/>
                                <ComboBoxItem Content="Rotation"/>
                                <ComboBoxItem Content="Parallax"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- Text Animation Type -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Text Animation:"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <ComboBox x:Name="TextAnimationTypeComboBox"
                                      SelectedIndex="0"
                                      Style="{StaticResource ModernComboBox}">
                                <ComboBoxItem Content="None"/>
                                <ComboBoxItem Content="Fade"/>
                                <ComboBoxItem Content="Slide"/>
                                <ComboBoxItem Content="Typewriter"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- Easing Type -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Easing Type:"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <ComboBox x:Name="EasingTypeComboBox"
                                      SelectedIndex="0"
                                      Style="{StaticResource ModernComboBox}">
                                <ComboBoxItem Content="Linear"/>
                                <ComboBoxItem Content="Ease In"/>
                                <ComboBoxItem Content="Ease Out"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- Loop -->
                        <CheckBox x:Name="LoopCheckBox"
                                  Content="Loop Animation"
                                  IsChecked="True"
                                  FontSize="14"
                                  Foreground="{StaticResource TextPrimary}"
                                  Margin="0,0,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Interactive Effects Card -->
                <Border Style="{StaticResource ModernCard}" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="{StaticResource TextPrimary}"
                                   Margin="0,0,0,14">
                            <Run Text="ðŸ–±ï¸" FontFamily="Segoe UI Emoji"/>
                            <Run Text=" Interactive Effects"/>
                        </TextBlock>

                        <!-- Mouse Tracking -->
                        <StackPanel Margin="0,0,0,12">
                            <CheckBox x:Name="MouseTrackingCheckBox"
                                      Content="Enable Mouse Tracking (Parallax)"
                                      IsChecked="False"
                                      FontSize="14"
                                      Foreground="{StaticResource TextPrimary}"
                                      Margin="0,0,0,8"/>
                            <StackPanel Margin="20,0,0,0" IsEnabled="{Binding IsChecked, ElementName=MouseTrackingCheckBox}">
                                <TextBlock Text="Parallax Intensity:"
                                           FontSize="12"
                                           Foreground="{StaticResource TextSecondary}"
                                           Margin="0,0,0,4"/>
                                <Slider x:Name="ParallaxIntensitySlider" Minimum="0" Maximum="1" Value="0.5" TickFrequency="0.1" IsSnapToTickEnabled="True"/>
                                <TextBlock Text="{Binding Value, ElementName=ParallaxIntensitySlider, StringFormat='Intensity: {0:P0}'}" FontSize="11" Foreground="{StaticResource TextTertiary}" Margin="0,4,0,0"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- Clock Effects -->
                        <StackPanel Margin="0,0,0,0">
                            <CheckBox x:Name="ClockEffectsCheckBox"
                                      Content="Enable Clock Effects (Time-based)"
                                      IsChecked="False"
                                      FontSize="14"
                                      Foreground="{StaticResource TextPrimary}"
                                      Margin="0,0,0,8"/>
                            <StackPanel Margin="20,0,0,0" IsEnabled="{Binding IsChecked, ElementName=ClockEffectsCheckBox}">
                                <CheckBox x:Name="TimeColorShiftCheckBox"
                                          Content="Time-based Color Shift"
                                          IsChecked="True"
                                          FontSize="13"
                                          Foreground="{StaticResource TextSecondary}"
                                          Margin="0,0,0,4"/>
                                <CheckBox x:Name="TimeOpacityCheckBox"
                                          Content="Time-based Opacity"
                                          IsChecked="False"
                                          FontSize="13"
                                          Foreground="{StaticResource TextSecondary}"
                                          Margin="0,0,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Particle Effects Card -->
                <Border Style="{StaticResource ModernCard}" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="{StaticResource TextPrimary}"
                                   Margin="0,0,0,14">
                            <Run Text="âœ¨" FontFamily="Segoe UI Emoji"/>
                            <Run Text=" Particle Effects"/>
                        </TextBlock>

                        <!-- Particle Type -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Particle Type:"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <ComboBox x:Name="ParticleTypeComboBox"
                                      SelectedIndex="0"
                                      Style="{StaticResource ModernComboBox}">
                                <ComboBoxItem Content="None"/>
                                <ComboBoxItem Content="Snow"/>
                                <ComboBoxItem Content="Stars"/>
                                <ComboBoxItem Content="Sparkles"/>
                                <ComboBoxItem Content="Rain"/>
                            </ComboBox>
                        </StackPanel>

                        <!-- Particle Count -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Particle Count:"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <Slider x:Name="ParticleCountSlider" Minimum="10" Maximum="500" Value="100" TickFrequency="10" IsSnapToTickEnabled="True"/>
                            <TextBlock Text="{Binding Value, ElementName=ParticleCountSlider, StringFormat='Count: {0:F0}'}" FontSize="11" Foreground="{StaticResource TextTertiary}" Margin="0,4,0,0"/>
                        </StackPanel>

                        <!-- Particle Speed -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="Particle Speed:"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <Slider x:Name="ParticleSpeedSlider" Minimum="10" Maximum="200" Value="50" TickFrequency="10" IsSnapToTickEnabled="True"/>
                            <TextBlock Text="{Binding Value, ElementName=ParticleSpeedSlider, StringFormat='Speed: {0:F0}'}" FontSize="11" Foreground="{StaticResource TextTertiary}" Margin="0,4,0,0"/>
                        </StackPanel>

                        <!-- Particle Color -->
                        <StackPanel Margin="0,0,0,0">
                            <TextBlock Text="Particle Color:"
                                       FontSize="13"
                                       FontWeight="Medium"
                                       Foreground="{StaticResource TextSecondary}"
                                       Margin="0,0,0,8"/>
                            <Border Background="White" BorderBrush="{StaticResource BorderColor}" BorderThickness="1" Height="30" CornerRadius="4" Cursor="Hand" MouseLeftButtonUp="ParticleColorBorder_MouseLeftButtonUp">
                                <Border x:Name="ParticleColorPreview" Background="White" Margin="2"/>
                            </Border>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Export Format Card -->
                <Border Style="{StaticResource ModernCard}" Margin="0,0,0,12">
                    <StackPanel>
                        <TextBlock FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="{StaticResource TextPrimary}"
                                   Margin="0,0,0,14">
                            <Run Text="ðŸ“¤" FontFamily="Segoe UI Emoji"/>
                            <Run Text=" Export Format"/>
                        </TextBlock>

                        <RadioButton x:Name="GifRadioButton"
                                     Content="GIF (Animated)"
                                     IsChecked="True"
                                     GroupName="ExportFormat"
                                     FontSize="14"
                                     Foreground="{StaticResource TextPrimary}"
                                     Margin="0,0,0,12"/>
                        <RadioButton x:Name="Mp4RadioButton"
                                     Content="MP4 (Video)"
                                     GroupName="ExportFormat"
                                     FontSize="14"
                                     Foreground="{StaticResource TextPrimary}"
                                     Margin="0,0,0,0"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>


        <!-- Progress Bar (initially hidden) -->
        <StackPanel Grid.Row="3"
                    Orientation="Vertical"
                    Margin="0,20,0,0">
            <Border x:Name="ProgressBorder"
                    Background="{StaticResource CardBackground}"
                    BorderBrush="{StaticResource BorderColor}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,0,0,12"
                    Visibility="Collapsed">
                <StackPanel>
                    <TextBlock x:Name="ProgressText"
                               Text="Generating frames..."
                               FontSize="14"
                               Foreground="{StaticResource TextPrimary}"
                               Margin="0,0,0,8"/>
                    <ProgressBar x:Name="ProgressBar"
                                 Height="8"
                                 Minimum="0"
                                 Maximum="100"
                                 Value="0"/>
                </StackPanel>
            </Border>
            <!-- Action Buttons moved here to ensure they're always visible -->
            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Right">
                <Button x:Name="GenerateAnimationButton"
                        MinWidth="200"
                        Height="44"
                        Click="GenerateAnimationButton_Click"
                        Style="{StaticResource ModernPrimaryButton}"
                        Margin="0,0,12,0"
                        Padding="16,10">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸŽ¬" FontSize="16" Margin="0,0,8,0" FontFamily="Segoe UI Emoji"/>
                        <TextBlock Text="Generate Animation" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
                <Button x:Name="ExportButton"
                        MinWidth="150"
                        Height="44"
                        Click="ExportButton_Click"
                        Style="{StaticResource ModernSuccessButton}"
                        IsEnabled="False"
                        Padding="14,10">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="ðŸ’¾" FontSize="16" Margin="0,0,6,0" FontFamily="Segoe UI Emoji"/>
                        <TextBlock Text="Export" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
                <Button x:Name="CancelButton"
                        MinWidth="110"
                        Height="44"
                        Click="CancelButton_Click"
                        Style="{StaticResource ModernDangerButton}"
                        IsEnabled="False"
                        Margin="12,0,0,0"
                        Visibility="Collapsed"
                        Padding="12,10">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="âœ•" FontSize="16" Margin="0,0,6,0"/>
                        <TextBlock Text="Cancel" VerticalAlignment="Center" FontSize="13"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </StackPanel>
    </Grid>
</Page>

