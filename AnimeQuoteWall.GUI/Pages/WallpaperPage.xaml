<Page x:Class="AnimeQuoteWall.GUI.Pages.WallpaperPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
      Title="Static Wallpaper Generator">
    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/ButtonStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Page.Resources>
    <Grid Margin="24,20" SizeChanged="Page_SizeChanged">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*" MinHeight="300"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Preview Section Header -->
        <TextBlock Grid.Row="0"
                   Text="Wallpaper Preview"
                   FontSize="22"
                   FontWeight="Bold"
                   Foreground="{StaticResource TextPrimary}"
                   Margin="0,0,0,28"
                   RenderOptions.BitmapScalingMode="HighQuality"
                   TextOptions.TextRenderingMode="ClearType"/>

        <!-- Multi-Monitor Preview Card -->
        <Border Grid.Row="1"
                Background="{StaticResource HoverBackground}"
                BorderBrush="{StaticResource BorderColor}"
                BorderThickness="1"
                CornerRadius="16"
                Margin="0,0,0,20"
                Padding="16"
                MinHeight="400">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Opacity="0.1" BlurRadius="12" ShadowDepth="2"/>
            </Border.Effect>
            <Grid>
                <ScrollViewer x:Name="PreviewScrollViewer"
                              HorizontalScrollBarVisibility="Auto"
                              VerticalScrollBarVisibility="Auto"
                              PanningMode="Both"
                              MouseWheel="PreviewScrollViewer_MouseWheel"
                              SizeChanged="PreviewScrollViewer_SizeChanged">
                    <ItemsControl x:Name="MonitorPreviewsItemsControl">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <UniformGrid x:Name="MonitorPreviewsGrid" Columns="2" Rows="0"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Margin="8"
                                        Background="{StaticResource CardBackground}"
                                        BorderBrush="{StaticResource BorderColor}"
                                        BorderThickness="2"
                                        CornerRadius="12"
                                        Padding="12"
                                        Cursor="Hand"
                                        MouseLeftButtonUp="MonitorPreview_MouseLeftButtonUp">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="BorderBrush" Value="#7C83FF"/>
                                                    <Setter Property="Effect">
                                                        <Setter.Value>
                                                            <DropShadowEffect Color="#7C83FF" Opacity="0.2" BlurRadius="8" ShadowDepth="0"/>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <StackPanel>
                                        <TextBlock Text="{Binding MonitorName}"
                                                   FontSize="14"
                                                   FontWeight="SemiBold"
                                                   Foreground="{StaticResource TextPrimary}"
                                                   Margin="0,0,0,8"
                                                   HorizontalAlignment="Center"/>
                                        <Border Background="{StaticResource HoverBackground}"
                                                BorderBrush="{StaticResource BorderColor}"
                                                BorderThickness="1"
                                                CornerRadius="8"
                                                Height="200"
                                                ClipToBounds="True">
                                            <Image Source="{Binding PreviewImage}"
                                                   Stretch="Uniform"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   RenderOptions.BitmapScalingMode="HighQuality"/>
                                        </Border>
                                        <TextBlock Text="{Binding QuoteText}"
                                                   FontSize="11"
                                                   Foreground="{StaticResource TextSecondary}"
                                                   TextWrapping="Wrap"
                                                   TextTrimming="CharacterEllipsis"
                                                   MaxHeight="40"
                                                   Margin="0,6,0,0"
                                                   HorizontalAlignment="Center"
                                                   TextAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
                <Border x:Name="NoPreviewBorder"
                        Background="Transparent"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center">
                    <StackPanel>
                        <iconPacks:PackIconMaterial Kind="PaletteOutline"
                                                    Width="48"
                                                    Height="48"
                                                    HorizontalAlignment="Center"
                                                    Margin="0,0,0,12"
                                                    Opacity="0.3"/>
                        <TextBlock x:Name="NoPreviewText"
                                   Text="No wallpaper generated yet.&#x0a;Click 'Generate New Wallpaper' to create one!"
                                   FontSize="15"
                                   Foreground="{StaticResource TextTertiary}"
                                   HorizontalAlignment="Center"
                                   TextAlignment="Center"
                                   TextWrapping="Wrap"
                                   MaxWidth="400"
                                   LineHeight="24"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    Margin="0,12,0,0"
                    x:Name="ActionButtonsPanel">
            <Button x:Name="GenerateButton"
                    MinWidth="180"
                    Height="44"
                    Click="GenerateButton_Click"
                    Style="{StaticResource ModernPrimaryButton}"
                    Padding="16,10"
                    ToolTip="Generate wallpaper for selected monitor">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconMaterial Kind="FlashOutline" Width="18" Height="18" Margin="0,0,8,0" VerticalAlignment="Center" Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"/>
                    <TextBlock Text="Generate" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <Button x:Name="GenerateAllMonitorsButton"
                    MinWidth="200"
                    Height="44"
                    Click="GenerateAllMonitorsButton_Click"
                    Style="{StaticResource ModernPrimaryButton}"
                    Margin="12,0,0,0"
                    Padding="16,10"
                    IsEnabled="False"
                    ToolTip="Multi-monitor feature temporarily disabled for stability">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconMaterial Kind="Monitor" Width="18" Height="18" Margin="0,0,8,0" VerticalAlignment="Center" Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"/>
                    <TextBlock Text="Generate All Monitors" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <Button x:Name="RefreshButton"
                    MinWidth="140"
                    Height="44"
                    Click="RefreshButton_Click"
                    Style="{StaticResource ModernSecondaryButton}"
                    Margin="12,0,0,0"
                    Padding="14,10">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconMaterial Kind="Refresh" Width="18" Height="18" Margin="0,0,6,0" VerticalAlignment="Center" Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"/>
                    <TextBlock Text="Refresh" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <Button x:Name="RemoveGeneratedButton"
                    MinWidth="160"
                    Height="44"
                    Click="RemoveGeneratedButton_Click"
                    Style="{StaticResource ModernDangerButton}"
                    Margin="12,0,0,0"
                    Padding="14,10"
                    ToolTip="Remove the generated wallpaper and restore previous">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconMaterial Kind="DeleteOutline" Width="18" Height="18" Margin="0,0,6,0" VerticalAlignment="Center" Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"/>
                    <TextBlock Text="Remove Generated" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
            <StackPanel Orientation="Horizontal" Margin="12,0,0,0">
                <ComboBox x:Name="MonitorSelectionComboBox"
                          Width="200"
                          Height="44"
                          VerticalContentAlignment="Center"
                          FontSize="13"
                          Margin="0,0,10,0"
                          ToolTip="Select monitor(s) to apply wallpaper">
                    <ComboBoxItem Content="Use Settings Default" Tag="Default" IsSelected="True"/>
                </ComboBox>
                <Button x:Name="ApplyButton"
                        MinWidth="180"
                        Height="44"
                        Click="ApplyButton_Click"
                        Style="{StaticResource ModernSuccessButton}"
                        Padding="14,10">
                    <StackPanel Orientation="Horizontal">
                        <iconPacks:PackIconMaterial Kind="CheckCircleOutline" Width="18" Height="18" Margin="0,0,6,0" VerticalAlignment="Center"/>
                        <TextBlock Text="Apply as Wallpaper" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
            </StackPanel>
            <StackPanel Orientation="Horizontal" Margin="12,0,0,0">
                <Button x:Name="ZoomInButton"
                        Width="44"
                        Height="44"
                        Click="ZoomInButton_Click"
                        Style="{StaticResource ModernSecondaryButton}"
                        ToolTip="Zoom In"
                        Padding="0">
                    <iconPacks:PackIconMaterial Kind="MagnifyPlusOutline" Width="18" Height="18" VerticalAlignment="Center"/>
                </Button>
                <Button x:Name="ZoomOutButton"
                        Width="44"
                        Height="44"
                        Click="ZoomOutButton_Click"
                        Style="{StaticResource ModernSecondaryButton}"
                        Margin="6,0,0,0"
                        ToolTip="Zoom Out"
                        Padding="0">
                    <iconPacks:PackIconMaterial Kind="MagnifyMinusOutline" Width="18" Height="18" VerticalAlignment="Center"/>
                </Button>
                <Button x:Name="ZoomResetButton"
                        Width="44"
                        Height="44"
                        Click="ZoomResetButton_Click"
                        Style="{StaticResource ModernSecondaryButton}"
                        Margin="6,0,0,0"
                        ToolTip="Reset Zoom"
                        Padding="0">
                    <iconPacks:PackIconMaterial Kind="Restore" Width="18" Height="18" VerticalAlignment="Center"/>
                </Button>
                <Button x:Name="CompareButton"
                        MinWidth="110"
                        Height="44"
                        Click="CompareButton_Click"
                        Style="{StaticResource ModernSecondaryButton}"
                        Margin="6,0,0,0"
                        ToolTip="Compare with previous wallpaper"
                        Padding="12,10">
                    <StackPanel Orientation="Horizontal">
                        <iconPacks:PackIconMaterial Kind="Compare" Width="16" Height="16" Margin="0,0,4,0" VerticalAlignment="Center"/>
                        <TextBlock Text="Compare" VerticalAlignment="Center" FontSize="13"/>
                    </StackPanel>
                </Button>
            </StackPanel>
            <TextBlock x:Name="ZoomLevelText"
                       Text="100%"
                       FontSize="13"
                       FontWeight="Medium"
                       Foreground="{StaticResource TextSecondary}"
                       VerticalAlignment="Center"
                       Margin="14,0,0,0"
                       MinWidth="45"
                       TextAlignment="Center"/>
        </StackPanel>
    </Grid>
</Page>

